% --------------------------------------------------------------------------------
% Electron scattering amplitues - P. Ahrenkiel (2018)
% --------------------------------------------------------------------------------

%values from Doyle & Turner, Acta Cryst. 24, 390.
function y=fe(const,diff,elem,s)
    fac=1+diff.EKeV/const.m0c2;
   
    a=zeros(4,1);b=zeros(4,1);
    cElem=char(elem);
    switch cElem
        case 'Al'%13
        a=[2.2756;2.4280;0.8578;0.3166];
        b=[72.322;19.7729;3.0799;0.4076];
        
        case 'Si'%14
        a=[2.1293;2.5233;0.8349;0.3216];
        b=[57.7748;16.4756;2.8796;0.3860];
 
        case 'P'%15
        a=[1.8882;2.4685;0.8046;0.3204];
        b=[44.8756;13.5383;2.6424;0.3608];
 
        case 'Ga'%31
        a=[2.3205;2.4855;1.6879;0.5992];
        b=[65.6019;15.4577;2.5806;0.351];
        
        case 'As'%33
        a=[2.3989;2.7898;1.5288;0.5936];
        b=[45.7179;12.8166;2.2799;0.3277];
       
        case 'In'%49
        a=[3.1528;3.5565;2.8180;0.8842];
        b=[66.6492;14.4494;2.9758;0.3345];
        
    end
    
    s=0.1*s;%change to 1/angstroms
    fac=0.1*fac;%change to nm
    y=0;
    for i=1:4
        y=y+a(i)*exp(-b(i)*s^2);
    end
    y=fac*y;
end
